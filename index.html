<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mountain Men: A Year in the Wild</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <style>
        body { margin: 0; padding: 0; }
        @keyframes diceRoll { from { transform: rotate(-12deg) scale(1.08); } to { transform: rotate(12deg) scale(0.92); } }
        @keyframes fadeUp { from { opacity:0; transform:translateY(12px); } to { opacity:1; transform:translateY(0); } }
        @keyframes pulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.04); } }
        @keyframes glow { 0%,100% { text-shadow: 0 0 10px #c0392b, 0 0 40px rgba(192,57,43,0.3); } 50% { text-shadow: 0 0 20px #e74c3c, 0 0 60px rgba(231,76,60,0.4); } }
        @keyframes float { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        * { box-sizing: border-box; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script>


// â”€â”€â”€ GAME DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const ATTRIBUTES = [
  { id: "strong", label: "Extra Strong", icon: "ğŸ’ª", desc: "Great at heavy lifting and fighting", color: "#c0392b" },
  { id: "tough", label: "Extra Tough", icon: "ğŸ›¡ï¸", desc: "Can survive injuries better", color: "#e67e22" },
  { id: "fast", label: "Extra Fast", icon: "ğŸ’¨", desc: "Quick on your feet", color: "#27ae60" },
  { id: "smart", label: "Extra Smart", icon: "ğŸ§ ", desc: "Good at solving problems", color: "#2980b9" },
  { id: "friendly", label: "Extra Friendly", icon: "ğŸ¤", desc: "Great at trading and making friends", color: "#8e44ad" },
];

const SUPPLIES = [
  { id: "rifle", label: "Flintlock Rifle", icon: "ğŸ”«", desc: "For hunting and protection", tags: ["hunting", "fighting"] },
  { id: "traps", label: "Beaver Traps", icon: "ğŸª¤", desc: "For catching beaver", tags: ["trapping"] },
  { id: "knife", label: "Hunting Knife", icon: "ğŸ”ª", desc: "For skinning and cutting", tags: ["hunting", "survival"] },
  { id: "rope", label: "Strong Rope", icon: "ğŸª¢", desc: "For tying and climbing", tags: ["survival", "travel"] },
  { id: "blanket", label: "Warm Blanket", icon: "ğŸ§£", desc: "For staying warm at night", tags: ["survival"] },
  { id: "compass", label: "Compass", icon: "ğŸ§­", desc: "For finding your way", tags: ["travel"] },
  { id: "cookpot", label: "Cooking Pot", icon: "ğŸ²", desc: "For cooking meals", tags: ["survival"] },
  { id: "medicine", label: "Medicine Kit", icon: "ğŸ’Š", desc: "For treating injuries", tags: ["survival"] },
  { id: "horses", label: "Horse", icon: "ğŸ´", desc: "For fast travel", tags: ["travel", "hunting"] },
  { id: "dogs", label: "Sled Dogs", icon: "ğŸ•", desc: "For winter travel", tags: ["travel"] },
  { id: "ammunition", label: "Extra Ammo", icon: "ğŸ¯", desc: "More shots for your rifle", tags: ["hunting", "fighting"] },
  { id: "fishhook", label: "Fish Hooks", icon: "ğŸ£", desc: "For catching fish", tags: ["hunting"] },
];

const MAX_SUPPLIES = 8;

// Events based on the Wyoming Museum's "Year in the Life" curriculum scenarios
// Each event has: season, title, story, what helps, good outcome, bad outcome
const EVENTS = [
  {
    season: "Spring",
    title: "Beaver Trapping Season",
    story: "Spring is the best time to trap beaver! Their fur is thick and valuable. You set your traps along the riverbank and wait.",
    helpedBy: { supplies: ["traps"], attributes: ["smart"] },
    goodText: "Your traps are perfectly set! You catch 3 beaver and earn points at the rendezvous!",
    badText: "Your traps weren't set right. You catch nothing this season. Oh well!",
    goodPoints: 3,
    badPoints: -1,
  },
  {
    season: "Spring",
    title: "River Crossing",
    story: "The snow is melting and the rivers are rising fast. Your group needs to cross a swollen river to reach new trapping grounds.",
    helpedBy: { supplies: ["rope", "horses"], attributes: ["strong", "smart"] },
    goodText: "You safely guide everyone across the rushing water! Great thinking!",
    badText: "The current is too strong! Someone falls in and you lose precious supplies.",
    goodPoints: 2,
    badPoints: -2,
  },
  {
    season: "Spring",
    title: "Grizzly Bear Attack!",
    story: "A huge grizzly bear stumbles into your camp! It's angry and hungry. What do you do?",
    helpedBy: { supplies: ["rifle", "ammunition"], attributes: ["strong", "fast"] },
    goodText: "You bravely fight off the grizzly! The other mountain men are impressed.",
    badText: "The grizzly charges and you have to run! You lose your cooking pot in the escape.",
    goodPoints: 3,
    badPoints: -2,
  },
  {
    season: "Summer",
    title: "The Rendezvous!",
    story: "All the mountain men gather at the annual Rendezvous to trade furs, tell stories, and have fun. This is the biggest event of the year!",
    helpedBy: { supplies: ["traps", "fishhook"], attributes: ["friendly"] },
    goodText: "You made lots of friends and traded your furs for great supplies! Everyone loves your stories.",
    badText: "You don't have much to trade this year. You watch the others celebrate with full packs.",
    goodPoints: 4,
    badPoints: -1,
  },
  {
    season: "Summer",
    title: "Hunting Buffalo",
    story: "A massive herd of buffalo is grazing nearby. Fresh meat would feed your group for weeks! Can you hunt them?",
    helpedBy: { supplies: ["rifle", "horses", "ammunition"], attributes: ["fast", "strong"] },
    goodText: "You ride fast and bring down a big buffalo! Your group eats well for days.",
    badText: "The buffalo stampede away before you get close. You go hungry tonight.",
    goodPoints: 3,
    badPoints: -1,
  },
  {
    season: "Summer",
    title: "Lice Outbreak!",
    story: "Ugh! Lice have taken over the camp. Everyone is scratching! Mountain men dealt with this all the time.",
    helpedBy: { supplies: ["medicine"], attributes: ["tough", "smart"] },
    goodText: "You figure out how to get rid of the lice using what you brought. Scratching over!",
    badText: "The lice are terrible! Everyone is miserable for weeks. You lose a point from being so sick.",
    goodPoints: 1,
    badPoints: -1,
  },
  {
    season: "Summer",
    title: "Lost in the Wilderness",
    story: "Oh no! A terrible storm hit and now you have no idea where you are. The woods all look the same!",
    helpedBy: { supplies: ["compass"], attributes: ["smart", "fast"] },
    goodText: "You use your skills to find your way back to camp! You're a real navigator.",
    badText: "You wander for days before finding your way. You're tired and hungry when you finally return.",
    goodPoints: 2,
    badPoints: -2,
  },
  {
    season: "Fall",
    title: "Preparing for Winter",
    story: "The leaves are changing and winter is coming fast. You need to gather food and fix your shelter before the snow falls.",
    helpedBy: { supplies: ["cookpot", "knife", "blanket"], attributes: ["smart", "tough"] },
    goodText: "Your camp is perfectly set up for winter! Warm food, dry shelter, and plenty of supplies.",
    badText: "You didn't prepare enough. When the first snow falls, you're not ready. Brrr!",
    goodPoints: 3,
    badPoints: -2,
  },
  {
    season: "Fall",
    title: "Trading with a Native Tribe",
    story: "A friendly Native American tribe passes through the area. They want to trade! This could be a great opportunity.",
    helpedBy: { supplies: ["knife", "rope"], attributes: ["friendly", "smart"] },
    goodText: "What a wonderful trade! You get warm clothes and food in exchange for your supplies.",
    badText: "The trade doesn't go well. You gave away too much for too little.",
    goodPoints: 3,
    badPoints: -1,
  },
  {
    season: "Winter",
    title: "Blizzard Hits!",
    story: "A massive blizzard slams into the mountains! Wind is howling and snow is piling up. Can your group survive?",
    helpedBy: { supplies: ["blanket", "cookpot", "dogs"], attributes: ["tough"] },
    goodText: "You hunker down and stay warm! The blizzard passes and your group is safe and sound.",
    badText: "The blizzard is brutal! You barely stay warm and run low on food.",
    goodPoints: 2,
    badPoints: -3,
  },
  {
    season: "Winter",
    title: "Fishing for Food",
    story: "The rivers are frozen but your group is hungry. Can you find a way to catch fish through the ice?",
    helpedBy: { supplies: ["fishhook", "knife"], attributes: ["smart", "tough"] },
    goodText: "You cut a hole in the ice and catch a big fish! Tonight's dinner is delicious.",
    badText: "The ice is too thick and you can't get through. Another hungry night.",
    goodPoints: 2,
    badPoints: -1,
  },
  {
    season: "Winter",
    title: "Avalanche!",
    story: "The mountain rumbles and a wall of snow comes crashing down toward your camp! Everyone needs to move NOW!",
    helpedBy: { supplies: ["horses", "dogs"], attributes: ["fast"] },
    goodText: "You move super fast and get everyone out of the way just in time! Phew!",
    badText: "The avalanche catches up to you! You lose some of your supplies but everyone survives.",
    goodPoints: 3,
    badPoints: -2,
  },
];

// â”€â”€â”€ DICE COMPONENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function Dice({ value, rolling }) {
  const dots = {
    1: [[50, 50]],
    2: [[25, 25], [75, 75]],
    3: [[25, 25], [50, 50], [75, 75]],
    4: [[25, 25], [75, 25], [25, 75], [75, 75]],
    5: [[25, 25], [75, 25], [50, 50], [25, 75], [75, 75]],
    6: [[25, 25], [75, 25], [25, 50], [75, 50], [25, 75], [75, 75]],
  };
  const positions = dots[value] || dots[1];

  return (
    <div
      style={{
        width: 80,
        height: 80,
        background: "linear-gradient(145deg, #f5f0e8, #e8ddd0)",
        borderRadius: 14,
        border: "3px solid #8b7355",
        boxShadow: rolling
          ? "0 2px 8px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.4)"
          : "0 4px 12px rgba(0,0,0,0.25), inset 0 1px 0 rgba(255,255,255,0.4)",
        position: "relative",
        animation: rolling ? "diceRoll 0.15s ease-in-out infinite alternate" : "none",
        transform: rolling ? "rotate(5deg)" : "rotate(0deg)",
        transition: "transform 0.2s",
      }}
    >
      {positions.map((pos, i) => (
        <div
          key={i}
          style={{
            position: "absolute",
            width: 14,
            height: 14,
            borderRadius: "50%",
            background: "radial-gradient(circle at 35% 35%, #3d2b1f, #1a0f0a)",
            left: `${pos[0]}%`,
            top: `${pos[1]}%`,
            transform: "translate(-50%, -50%)",
            boxShadow: "0 1px 2px rgba(0,0,0,0.3)",
          }}
        />
      ))}
    </div>
  );
}

// â”€â”€â”€ MAIN APP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function MountainManGame() {
  const [phase, setPhase] = useState("title"); // title, name, attribute, supplies, game, results
  const [playerName, setPlayerName] = useState("");
  const [mountainManName, setMountainManName] = useState("");
  const [chosenAttribute, setChosenAttribute] = useState(null);
  const [chosenSupplies, setChosenSupplies] = useState([]);
  const [currentEventIndex, setCurrentEventIndex] = useState(0);
  const [points, setPoints] = useState(0);
  const [diceValue, setDiceValue] = useState(1);
  const [rolling, setRolling] = useState(false);
  const [eventResult, setEventResult] = useState(null); // null | "good" | "bad"
  const [showResult, setShowResult] = useState(false);
  const [log, setLog] = useState([]);
  const rollTimerRef = useRef(null);
  const audioCtx = useRef(null);

  const getAudioCtx = () => {
    if (!audioCtx.current) audioCtx.current = new (window.AudioContext || window.webkitAudioContext)();
    return audioCtx.current;
  };

  const playSound = (type) => {
    try {
      const ctx = getAudioCtx();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.connect(gain);
      gain.connect(ctx.destination);
      if (type === "roll") {
        osc.type = "sawtooth";
        osc.frequency.setValueAtTime(200, ctx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(80, ctx.currentTime + 0.15);
        gain.gain.setValueAtTime(0.15, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.15);
        osc.start(ctx.currentTime);
        osc.stop(ctx.currentTime + 0.15);
      } else if (type === "good") {
        [523, 659, 784].forEach((f, i) => {
          const o = ctx.createOscillator();
          const g = ctx.createGain();
          o.connect(g); g.connect(ctx.destination);
          o.type = "sine"; o.frequency.value = f;
          g.gain.setValueAtTime(0.15, ctx.currentTime + i * 0.12);
          g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + i * 0.12 + 0.25);
          o.start(ctx.currentTime + i * 0.12);
          o.stop(ctx.currentTime + i * 0.12 + 0.25);
        });
      } else if (type === "bad") {
        [300, 200].forEach((f, i) => {
          const o = ctx.createOscillator();
          const g = ctx.createGain();
          o.connect(g); g.connect(ctx.destination);
          o.type = "sawtooth"; o.frequency.value = f;
          g.gain.setValueAtTime(0.12, ctx.currentTime + i * 0.2);
          g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + i * 0.2 + 0.3);
          o.start(ctx.currentTime + i * 0.2);
          o.stop(ctx.currentTime + i * 0.2 + 0.3);
        });
      }
    } catch (e) {}
  };

  const handleRoll = () => {
    if (rolling || showResult) return;
    setRolling(true);
    setEventResult(null);
    playSound("roll");
    let ticks = 0;
    const interval = setInterval(() => {
      setDiceValue(Math.floor(Math.random() * 6) + 1);
      ticks++;
      if (ticks > 12) {
        clearInterval(interval);
        const final = Math.floor(Math.random() * 6) + 1;
        setDiceValue(final);
        setRolling(false);
        resolveEvent(final);
      }
    }, 80);
    rollTimerRef.current = interval;
  };

  const resolveEvent = (roll) => {
    const event = EVENTS[currentEventIndex];
    // Success threshold: base is 4. Each matching supply or attribute lowers it by 1 (min 2)
    let bonus = 0;
    event.helpedBy.supplies.forEach((s) => { if (chosenSupplies.includes(s)) bonus++; });
    if (chosenAttribute && event.helpedBy.attributes.includes(chosenAttribute)) bonus++;
    const threshold = Math.max(2, 4 - bonus);
    const success = roll >= threshold;
    const result = success ? "good" : "bad";
    setEventResult(result);
    setShowResult(true);
    const pts = success ? event.goodPoints : event.badPoints;
    setPoints((p) => p + pts);
    setLog((prev) => [...prev, { event: event.title, result, points: pts, roll, threshold }]);
    playSound(result);
  };

  const nextEvent = () => {
    setShowResult(false);
    setEventResult(null);
    if (currentEventIndex < EVENTS.length - 1) {
      setCurrentEventIndex((i) => i + 1);
    } else {
      setPhase("results");
    }
  };

  const toggleSupply = (id) => {
    setChosenSupplies((prev) =>
      prev.includes(id) ? prev.filter((s) => s !== id) : prev.length < MAX_SUPPLIES ? [...prev, id] : prev
    );
  };

  const event = EVENTS[currentEventIndex];
  const progress = ((currentEventIndex + (showResult ? 1 : 0)) / EVENTS.length) * 100;

  // â”€â”€â”€ STYLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const bg = "linear-gradient(180deg, #2c1810 0%, #1a0f0a 40%, #0d0906 100%)";
  const parchment = "linear-gradient(145deg, #f5f0e0, #ede4cc, #e8dcc8)";
  const btnStyle = (active) => ({
    background: active ? "linear-gradient(135deg, #c0392b, #922b21)" : parchment,
    color: active ? "#fff" : "#3d2b1f",
    border: active ? "2px solid #a93226" : "2px solid #8b7355",
    borderRadius: 10,
    padding: "10px 18px",
    cursor: "pointer",
    fontFamily: "'Georgia', serif",
    fontSize: 14,
    fontWeight: active ? 600 : 500,
    boxShadow: active ? "0 3px 8px rgba(0,0,0,0.3)" : "0 2px 4px rgba(0,0,0,0.15)",
    transition: "all 0.2s",
    display: "flex",
    alignItems: "center",
    gap: 8,
  });

  const seasonColors = { Spring: "#27ae60", Summer: "#e67e22", Fall: "#d35400", Winter: "#2980b9" };

  // â”€â”€â”€ TITLE SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (phase === "title") {
    return (
      <div style={{ minHeight: "100vh", background: bg, display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", padding: 24, fontFamily: "'Georgia', serif" }}>
        <style>{`
          @keyframes diceRoll { from { transform: rotate(-8deg) scale(1.05); } to { transform: rotate(8deg) scale(0.95); } }
          @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
          @keyframes glow { 0%,100% { text-shadow: 0 0 10px #c0392b, 0 0 40px rgba(192,57,43,0.3); } 50% { text-shadow: 0 0 20px #e74c3c, 0 0 60px rgba(231,76,60,0.4); } }
          @keyframes float { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
          * { box-sizing: border-box; }
        `}</style>
        <div style={{ textAlign: "center", animation: "fadeUp 0.8s ease" }}>
          <div style={{ fontSize: 72, marginBottom: 8, animation: "float 3s ease-in-out infinite" }}>ğŸ”ï¸</div>
          <h1 style={{ color: "#f5f0e0", fontSize: 38, margin: 0, fontWeight: 700, letterSpacing: 2, animation: "glow 3s ease-in-out infinite", textShadow: "0 0 10px rgba(192,57,43,0.5)" }}>
            MOUNTAIN MEN
          </h1>
          <h2 style={{ color: "#c0a882", fontSize: 18, margin: "6px 0 0", fontWeight: 400, letterSpacing: 3, textTransform: "uppercase" }}>
            A Year in the Wild
          </h2>
          <div style={{ width: 80, height: 2, background: "linear-gradient(90deg, transparent, #8b7355, transparent)", margin: "16px auto" }} />
          <p style={{ color: "#a89070", fontSize: 15, maxWidth: 420, margin: "0 auto 32px", lineHeight: 1.6 }}>
            It's 1835. You're heading into the Rocky Mountains to trap beaver fur. Build your mountain man, pack your supplies, and survive the year!
          </p>
          <p style={{ color: "#7a6a5a", fontSize: 13, maxWidth: 380, margin: "0 auto 28px", lineHeight: 1.5, fontStyle: "italic" }}>
            Based on the Wyoming State Museum's "Year in the Life of the Mountain Men" program â€” real events that happened to real fur trappers!
          </p>
          <button onClick={() => setPhase("name")} style={{ ...btnStyle(true), padding: "14px 42px", fontSize: 18, margin: "0 auto", display: "block" }}>
            ğŸ’ Begin Your Journey
          </button>
        </div>
      </div>
    );
  }

  // â”€â”€â”€ NAME SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (phase === "name") {
    return (
      <div style={{ minHeight: "100vh", background: bg, display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", padding: 24, fontFamily: "'Georgia', serif" }}>
        <style>{`@keyframes fadeUp { from { opacity:0; transform:translateY(16px); } to { opacity:1; transform:translateY(0); } } * { box-sizing:border-box; }`}</style>
        <div style={{ background: parchment, borderRadius: 18, padding: "36px 32px", maxWidth: 480, width: "100%", boxShadow: "0 8px 32px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.3)", animation: "fadeUp 0.5s ease" }}>
          <div style={{ textAlign: "center", marginBottom: 24 }}>
            <div style={{ fontSize: 48 }}>ğŸ¤ </div>
            <h2 style={{ color: "#3d2b1f", margin: "8px 0 4px", fontSize: 24 }}>Name Your Mountain Man</h2>
            <p style={{ color: "#7a6a5a", margin: 0, fontSize: 14 }}>What will your brave fur trapper be called?</p>
          </div>
          <div style={{ marginBottom: 20 }}>
            <label style={{ color: "#5a4a3a", fontSize: 13, fontWeight: 600, display: "block", marginBottom: 6 }}>YOUR NAME</label>
            <input value={playerName} onChange={(e) => setPlayerName(e.target.value)} placeholder="e.g. Sarah" style={{ width: "100%", padding: "10px 14px", borderRadius: 8, border: "2px solid #c4b896", fontSize: 15, fontFamily: "'Georgia', serif", background: "#faf7f0", color: "#3d2b1f", outline: "none" }} />
          </div>
          <div style={{ marginBottom: 28 }}>
            <label style={{ color: "#5a4a3a", fontSize: 13, fontWeight: 600, display: "block", marginBottom: 6 }}>YOUR MOUNTAIN MAN'S NAME</label>
            <input value={mountainManName} onChange={(e) => setMountainManName(e.target.value)} placeholder="e.g. Old Pete McGraw" style={{ width: "100%", padding: "10px 14px", borderRadius: 8, border: "2px solid #c4b896", fontSize: 15, fontFamily: "'Georgia', serif", background: "#faf7f0", color: "#3d2b1f", outline: "none" }} />
          </div>
          <div style={{ display: "flex", justifyContent: "space-between" }}>
            <button onClick={() => setPhase("title")} style={{ ...btnStyle(false), padding: "10px 20px" }}>â† Back</button>
            <button onClick={() => setPhase("attribute")} disabled={!mountainManName.trim()} style={{ ...btnStyle(true), padding: "10px 24px", opacity: mountainManName.trim() ? 1 : 0.5, cursor: mountainManName.trim() ? "pointer" : "not-allowed" }}>Next â†’</button>
          </div>
        </div>
      </div>
    );
  }

  // â”€â”€â”€ ATTRIBUTE SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (phase === "attribute") {
    return (
      <div style={{ minHeight: "100vh", background: bg, display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", padding: 24, fontFamily: "'Georgia', serif" }}>
        <style>{`@keyframes fadeUp { from { opacity:0; transform:translateY(16px); } to { opacity:1; transform:translateY(0); } } * { box-sizing:border-box; }`}</style>
        <div style={{ background: parchment, borderRadius: 18, padding: "36px 28px", maxWidth: 520, width: "100%", boxShadow: "0 8px 32px rgba(0,0,0,0.4)", animation: "fadeUp 0.5s ease" }}>
          <div style={{ textAlign: "center", marginBottom: 8 }}>
            <h2 style={{ color: "#3d2b1f", margin: 0, fontSize: 24 }}>â­ Choose One Special Skill</h2>
            <p style={{ color: "#7a6a5a", margin: "6px 0 0", fontSize: 14 }}>Every mountain man has one thing they're REALLY good at. What's {mountainManName}'s special talent?</p>
          </div>
          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 10, margin: "20px 0" }}>
            {ATTRIBUTES.map((attr) => {
              const selected = chosenAttribute === attr.id;
              return (
                <div key={attr.id} onClick={() => setChosenAttribute(attr.id)} style={{ background: selected ? `${attr.color}18` : "#fff", border: `2.5px solid ${selected ? attr.color : "#d4c9b0"}`, borderRadius: 12, padding: "12px 14px", cursor: "pointer", transition: "all 0.2s", boxShadow: selected ? `0 3px 12px ${attr.color}40` : "0 1px 3px rgba(0,0,0,0.08)" }}>
                  <div style={{ display: "flex", alignItems: "center", gap: 10 }}>
                    <div style={{ fontSize: 28, width: 38, height: 38, display: "flex", alignItems: "center", justifyContent: "center", background: selected ? attr.color : "#f0ebe0", borderRadius: 8 }}>{attr.icon}</div>
                    <div>
                      <div style={{ color: selected ? attr.color : "#3d2b1f", fontWeight: 700, fontSize: 14 }}>{attr.label}</div>
                      <div style={{ color: "#7a6a5a", fontSize: 12 }}>{attr.desc}</div>
                    </div>
                  </div>
                </div>
              );
            })}
          </div>
          <div style={{ display: "flex", justifyContent: "space-between", marginTop: 24 }}>
            <button onClick={() => setPhase("name")} style={{ ...btnStyle(false), padding: "10px 20px" }}>â† Back</button>
            <button onClick={() => setPhase("supplies")} disabled={!chosenAttribute} style={{ ...btnStyle(true), padding: "10px 24px", opacity: chosenAttribute ? 1 : 0.5, cursor: chosenAttribute ? "pointer" : "not-allowed" }}>Pack Supplies â†’</button>
          </div>
        </div>
      </div>
    );
  }

  // â”€â”€â”€ SUPPLIES SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (phase === "supplies") {
    return (
      <div style={{ minHeight: "100vh", background: bg, display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", padding: 24, fontFamily: "'Georgia', serif" }}>
        <style>{`@keyframes fadeUp { from { opacity:0; transform:translateY(16px); } to { opacity:1; transform:translateY(0); } } * { box-sizing:border-box; }`}</style>
        <div style={{ background: parchment, borderRadius: 18, padding: "32px 28px", maxWidth: 560, width: "100%", boxShadow: "0 8px 32px rgba(0,0,0,0.4)", animation: "fadeUp 0.5s ease" }}>
          <div style={{ textAlign: "center", marginBottom: 4 }}>
            <h2 style={{ color: "#3d2b1f", margin: 0, fontSize: 24 }}>ğŸ’ Pack Your Supplies</h2>
            <p style={{ color: "#7a6a5a", margin: "6px 0 0", fontSize: 14 }}>Choose up to <strong>{MAX_SUPPLIES}</strong> items to bring into the mountains. Choose wisely â€” you can't bring everything!</p>
          </div>
          <div style={{ display: "flex", justifyContent: "center", alignItems: "center", gap: 8, background: "#3d2b1f22", borderRadius: 20, padding: "6px 16px", width: "fit-content", margin: "14px auto 18px" }}>
            <span style={{ color: "#c0a882", fontSize: 14 }}>Supplies packed:</span>
            <span style={{ color: chosenSupplies.length === MAX_SUPPLIES ? "#e74c3c" : "#27ae60", fontWeight: 700, fontSize: 16 }}>{chosenSupplies.length}</span>
            <span style={{ color: "#c0a882", fontSize: 14 }}>/ {MAX_SUPPLIES}</span>
          </div>
          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 8 }}>
            {SUPPLIES.map((item) => {
              const selected = chosenSupplies.includes(item.id);
              const disabled = !selected && chosenSupplies.length >= MAX_SUPPLIES;
              return (
                <div key={item.id} onClick={() => !disabled && toggleSupply(item.id)} style={{ background: selected ? "#c0392b15" : disabled ? "#f5f5f0" : "#fff", border: `2px solid ${selected ? "#c0392b" : disabled ? "#ddd" : "#d4c9b0"}`, borderRadius: 10, padding: "10px 12px", cursor: disabled ? "not-allowed" : "pointer", transition: "all 0.15s", opacity: disabled ? 0.5 : 1, display: "flex", alignItems: "center", gap: 10 }}>
                  <div style={{ fontSize: 24, width: 34, height: 34, display: "flex", alignItems: "center", justifyContent: "center", background: selected ? "#c0392b" : "#efe9dc", borderRadius: 7, transition: "background 0.2s" }}>{item.icon}</div>
                  <div style={{ flex: 1 }}>
                    <div style={{ color: selected ? "#c0392b" : "#3d2b1f", fontWeight: 600, fontSize: 13 }}>{item.label}</div>
                    <div style={{ color: "#7a6a5a", fontSize: 11 }}>{item.desc}</div>
                  </div>
                  {selected && <div style={{ color: "#c0392b", fontSize: 18, fontWeight: 700 }}>âœ“</div>}
                </div>
              );
            })}
          </div>
          <div style={{ display: "flex", justifyContent: "space-between", marginTop: 22 }}>
            <button onClick={() => setPhase("attribute")} style={{ ...btnStyle(false), padding: "10px 20px" }}>â† Back</button>
            <button onClick={() => setPhase("game")} disabled={chosenSupplies.length === 0} style={{ ...btnStyle(true), padding: "10px 28px", fontSize: 16, opacity: chosenSupplies.length > 0 ? 1 : 0.5, cursor: chosenSupplies.length > 0 ? "pointer" : "not-allowed" }}>
              ğŸ”ï¸ Head Into the Mountains!
            </button>
          </div>
        </div>
      </div>
    );
  }

  // â”€â”€â”€ GAME SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (phase === "game") {
    const hasHelp = event.helpedBy.supplies.some((s) => chosenSupplies.includes(s)) || event.helpedBy.attributes.includes(chosenAttribute);

    return (
      <div style={{ minHeight: "100vh", background: bg, display: "flex", flexDirection: "column", alignItems: "center", padding: "20px 16px", fontFamily: "'Georgia', serif" }}>
        <style>{`
          @keyframes diceRoll { from { transform: rotate(-12deg) scale(1.08); } to { transform: rotate(12deg) scale(0.92); } }
          @keyframes fadeUp { from { opacity:0; transform:translateY(12px); } to { opacity:1; transform:translateY(0); } }
          @keyframes pulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.04); } }
          * { box-sizing:border-box; }
        `}</style>

        {/* Header bar */}
        <div style={{ width: "100%", maxWidth: 560, display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 12 }}>
          <div style={{ color: "#c0a882", fontSize: 13 }}>ğŸ¤  <strong>{mountainManName}</strong> â€” {chosenAttribute && ATTRIBUTES.find((a) => a.id === chosenAttribute)?.label}</div>
          <div style={{ background: points >= 0 ? "#27ae6033" : "#c0392b33", borderRadius: 20, padding: "4px 14px", color: points >= 0 ? "#27ae60" : "#e74c3c", fontWeight: 700, fontSize: 16 }}>
            {points >= 0 ? "+" : ""}{points} pts
          </div>
        </div>

        {/* Progress bar */}
        <div style={{ width: "100%", maxWidth: 560, height: 6, background: "#3d2b1f55", borderRadius: 3, marginBottom: 16, overflow: "hidden" }}>
          <div style={{ height: "100%", width: `${progress}%`, background: "linear-gradient(90deg, #27ae60, #2ecc71)", borderRadius: 3, transition: "width 0.4s" }} />
        </div>

        {/* Season badge + Event card */}
        <div style={{ width: "100%", maxWidth: 560, animation: "fadeUp 0.4s ease", key: currentEventIndex }}>
          <div style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 8 }}>
            <span style={{ background: seasonColors[event.season], color: "#fff", fontSize: 11, fontWeight: 700, padding: "3px 10px", borderRadius: 12, textTransform: "uppercase", letterSpacing: 1 }}>{event.season}</span>
            <span style={{ color: "#7a6a5a", fontSize: 12 }}>Event {currentEventIndex + 1} of {EVENTS.length}</span>
          </div>

          <div style={{ background: parchment, borderRadius: 16, padding: "22px 24px", boxShadow: "0 6px 24px rgba(0,0,0,0.35)", borderTop: `4px solid ${seasonColors[event.season]}` }}>
            <h3 style={{ color: "#3d2b1f", margin: "0 0 10px", fontSize: 20 }}>{event.title}</h3>
            <p style={{ color: "#4a3828", margin: "0 0 16px", fontSize: 14, lineHeight: 1.6 }}>{event.story}</p>

            {/* What helps hint */}
            {!showResult && (
              <div style={{ background: "#3d2b1f0f", borderRadius: 8, padding: "8px 12px", marginBottom: 16, display: "flex", flexWrap: "wrap", gap: 6, alignItems: "center" }}>
                <span style={{ color: "#7a6a5a", fontSize: 12, fontWeight: 600 }}>Might help:</span>
                {event.helpedBy.supplies.map((s) => {
                  const item = SUPPLIES.find((i) => i.id === s);
                  const have = chosenSupplies.includes(s);
                  return <span key={s} style={{ fontSize: 12, background: have ? "#27ae6022" : "#ddd8cc", color: have ? "#27ae60" : "#7a6a5a", borderRadius: 12, padding: "2px 8px", fontWeight: have ? 600 : 400 }}>{item?.icon} {item?.label} {have ? "âœ“" : ""}</span>;
                })}
                {event.helpedBy.attributes.map((a) => {
                  const attr = ATTRIBUTES.find((x) => x.id === a);
                  const have = chosenAttribute === a;
                  return <span key={a} style={{ fontSize: 12, background: have ? "#2980b922" : "#ddd8cc", color: have ? "#2980b9" : "#7a6a5a", borderRadius: 12, padding: "2px 8px", fontWeight: have ? 600 : 400 }}>{attr?.icon} {attr?.label} {have ? "âœ“" : ""}</span>;
                })}
              </div>
            )}

            {/* Result display */}
            {showResult && (
              <div style={{ background: eventResult === "good" ? "#27ae6012" : "#c0392b12", border: `2px solid ${eventResult === "good" ? "#27ae60" : "#c0392b"}`, borderRadius: 12, padding: "14px 16px", marginBottom: 16, animation: "fadeUp 0.35s ease" }}>
                <div style={{ display: "flex", alignItems: "center", gap: 8, marginBottom: 6 }}>
                  <span style={{ fontSize: 22 }}>{eventResult === "good" ? "ğŸ‰" : "ğŸ˜Ÿ"}</span>
                  <span style={{ color: eventResult === "good" ? "#27ae60" : "#c0392b", fontWeight: 700, fontSize: 15 }}>{eventResult === "good" ? "Success!" : "Oh no!"}</span>
                  <span style={{ color: "#7a6a5a", fontSize: 13, marginLeft: "auto" }}>{eventResult === "good" ? `+${event.goodPoints}` : event.badPoints} pts</span>
                </div>
                <p style={{ color: "#4a3828", margin: 0, fontSize: 14, lineHeight: 1.5 }}>{eventResult === "good" ? event.goodText : event.badText}</p>
              </div>
            )}

            {/* Dice area */}
            <div style={{ display: "flex", flexDirection: "column", alignItems: "center", gap: 12 }}>
              <div style={{ display: "flex", alignItems: "center", gap: 16 }}>
                <Dice value={diceValue} rolling={rolling} />
                <div style={{ textAlign: "left" }}>
                  <div style={{ color: "#7a6a5a", fontSize: 12 }}>
                    {!showResult ? (hasHelp ? "ğŸŸ¢ You have helpful supplies/skills!" : "You'll need some luck...") : `You rolled a ${diceValue}`}
                  </div>
                  {showResult && <div style={{ color: "#7a6a5a", fontSize: 11 }}>Needed: {Math.max(2, 4 - (event.helpedBy.supplies.filter((s) => chosenSupplies.includes(s)).length + (event.helpedBy.attributes.includes(chosenAttribute) ? 1 : 0)))} or higher</div>}
                </div>
              </div>

              {!showResult ? (
                <button onClick={handleRoll} style={{ ...btnStyle(true), padding: "12px 36px", fontSize: 17, animation: "pulse 2s ease-in-out infinite" }}>
                  ğŸ² Roll the Dice!
                </button>
              ) : (
                <button onClick={nextEvent} style={{ ...btnStyle(true), padding: "10px 28px", fontSize: 15 }}>
                  {currentEventIndex < EVENTS.length - 1 ? "Next Event â†’" : "See Results ğŸ†"}
                </button>
              )}
            </div>
          </div>
        </div>
      </div>
    );
  }

  // â”€â”€â”€ RESULTS SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (phase === "results") {
    let title, titleColor, emoji;
    if (points >= 12) { title = "Mountain Man Legend!"; titleColor = "#f1c40f"; emoji = "ğŸ†"; }
    else if (points >= 6) { title = "Skilled Trapper!"; titleColor = "#27ae60"; emoji = "â­"; }
    else if (points >= 0) { title = "Survived the Year!"; titleColor = "#c0a882"; emoji = "ğŸ‘"; }
    else { title = "Tough Times Ahead..."; titleColor = "#e74c3c"; emoji = "ğŸ’ª"; }

    const good = log.filter((e) => e.result === "good").length;
    const bad = log.filter((e) => e.result === "bad").length;

    return (
      <div style={{ minHeight: "100vh", background: bg, display: "flex", flexDirection: "column", alignItems: "center", padding: "32px 20px", fontFamily: "'Georgia', serif" }}>
        <style>{`@keyframes fadeUp { from { opacity:0; transform:translateY(16px); } to { opacity:1; transform:translateY(0); } } @keyframes pop { 0% { transform: scale(0.5); opacity:0; } 60% { transform: scale(1.1); } 100% { transform: scale(1); opacity:1; } } * { box-sizing:border-box; }`}</style>
        <div style={{ maxWidth: 520, width: "100%", textAlign: "center" }}>
          <div style={{ fontSize: 64, animation: "pop 0.5s ease" }}>{emoji}</div>
          <h1 style={{ color: titleColor, fontSize: 30, margin: "8px 0 4px", animation: "fadeUp 0.4s ease 0.2s both" }}>{title}</h1>
          <p style={{ color: "#c0a882", fontSize: 16, margin: "0 0 24px", animation: "fadeUp 0.4s ease 0.3s both" }}>
            {mountainManName} finished the year with <strong style={{ color: titleColor }}>{points} points</strong>
          </p>

          {/* Stats card */}
          <div style={{ background: parchment, borderRadius: 16, padding: "24px", boxShadow: "0 6px 24px rgba(0,0,0,0.35)", marginBottom: 20, animation: "fadeUp 0.4s ease 0.4s both" }}>
            <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr 1fr", gap: 12, marginBottom: 20 }}>
              {[
                { label: "Events Won", val: good, color: "#27ae60", icon: "âœ“" },
                { label: "Events Lost", val: bad, color: "#e74c3c", icon: "âœ—" },
                { label: "Final Score", val: points, color: titleColor, icon: emoji },
              ].map((stat) => (
                <div key={stat.label} style={{ background: "#fff", borderRadius: 10, padding: "12px 8px", textAlign: "center", border: "1px solid #e8dcc8" }}>
                  <div style={{ fontSize: 24, color: stat.color }}>{stat.icon}</div>
                  <div style={{ color: stat.color, fontSize: 24, fontWeight: 700 }}>{stat.val}</div>
                  <div style={{ color: "#7a6a5a", fontSize: 11 }}>{stat.label}</div>
                </div>
              ))}
            </div>

            {/* Event log */}
            <div style={{ borderTop: "1px solid #e8dcc8", paddingTop: 16 }}>
              <h4 style={{ color: "#3d2b1f", margin: "0 0 10px", fontSize: 14, textAlign: "left" }}>ğŸ“œ Your Adventure Log</h4>
              <div style={{ maxHeight: 200, overflowY: "auto", display: "flex", flexDirection: "column", gap: 4 }}>
                {log.map((entry, i) => (
                  <div key={i} style={{ display: "flex", alignItems: "center", gap: 8, padding: "5px 8px", borderRadius: 6, background: entry.result === "good" ? "#27ae6008" : "#c0392b08", textAlign: "left" }}>
                    <span style={{ fontSize: 14 }}>{entry.result === "good" ? "âœ…" : "âŒ"}</span>
                    <span style={{ color: "#4a3828", fontSize: 12, flex: 1 }}>{EVENTS[i]?.title}</span>
                    <span style={{ color: entry.result === "good" ? "#27ae60" : "#c0392b", fontWeight: 600, fontSize: 12 }}>{entry.points >= 0 ? "+" : ""}{entry.points}</span>
                  </div>
                ))}
              </div>
            </div>
          </div>

          {/* Play again */}
          <button onClick={() => { setPhase("title"); setCurrentEventIndex(0); setPoints(0); setLog([]); setShowResult(false); setEventResult(null); setChosenAttribute(null); setChosenSupplies([]); setPlayerName(""); setMountainManName(""); }} style={{ ...btnStyle(true), padding: "12px 32px", fontSize: 16 }}>
            ğŸ”„ Play Again
          </button>
        </div>
      </div>
    );
  }

  return null;
}

const { useState, useRef } = React;
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(React.createElement(MountainManGame));
    </script>
</body>
</html>
